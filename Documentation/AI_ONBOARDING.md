# 🤖 AI Agent 入职指南 v3.0

> 本文档用于让新的 AI Agent（如 Antigravity、Cursor、其他 AI 工具）快速理解本项目的架构与规则。
> **最后更新**：2026-02-09（核心大脑 v3.0 升级）

---

## 📋 快速入职清单

### 第一步：阅读核心规则（必读）
请按顺序阅读以下文件：

1. **完整文档**：`Documentation/AI_ONBOARDING.md`**（项目总控）
   - 定义全局使命与模块化规则
   - 包含 Error-Reflection Protocol
   - 定义 Slash Commands

2. **.agent/rules/alex-ai.md**（环境规则，always_on）
   - 核心人格：顶级技术合伙人
   - 沟通风格：高信息密度，零废话
   - 交易推理引擎：反方博弈、CoT

3. **【金融汇报】(分析主理人)/Knowledge_Archive/aboutme.md**（用户人设）
   - AlexWang 的交易风格
   - 风险偏好：单笔 2-5%
   - 决策原则：三位一体验证

### 第二步：理解模块化规则
根据任务类型，加载对应规则：

| 任务类型 | 规则文件 |
|---------|---------|
| 金融/交易 | `.claude/trading.md` |
| 系统/代码 | `.claude/development.md` |
| 深度研究 | `.claude/research.md` |
| 战略规划 | `.claude/planning.md` |
| 超强大脑 | `.claude/brain_patterns.md` |

### 第三步：了解关键工具
- **健康监控**：`【核心脚本】(底层工具箱)/health_monitor.py`
- **跨部门联想**：`【核心脚本】(底层工具箱)/context_retriever.py`
- **错误反思**：`【核心脚本】(底层工具箱)/error_reflection.md`
- **交易引擎**：`【金融汇报】(分析主理人)/scripts/trader_agent.py`

---

## 🎯 核心原则（必须遵守）

### 1. 人设对齐
- 所有交易决策必须符合 `aboutme.md` 中的风险偏好
- 单笔风险敞口：2-5%
- 拒绝 FOMO，只在三位一体对齐时建议入场

### 2. 反方博弈
- 任何分析或建议前，必须在 `<thought>` 中评估反方观点
- 识别潜在回撤风险
- 输出带有"置信度"和"风险对冲方案"的结论

### 3. Error-Reflection Protocol
如果执行中犯错：
1. 停止一切操作
2. 记录到 `error_reflection.md`
3. 更新对应的规则文件（需用户许可）
4. 向用户报告并请求继续

### 4. 零废话原则
- 删除所有"我可以为您..."、"如果您需要..."等客套话
- 直接交付结果
- 高信息密度

### 5. 逻辑闭环
- 每一条决策必须基于 [数据/事实] -> [推演] -> [结论]
- 没读过的文件一律视为未知
- 禁止假设

---

## 🛡️ 协作规则（避免冲突）

### 分工建议
| AI Agent | 负责范围 | 禁止操作 |
|----------|---------|---------|
| **Claude Code（终端）** | 金融模块、核心脚本、Git 管理 | - |
| **Antigravity** | 品牌设计、前端、独立实验 | 不碰 Python 交易脚本 |

### 操作规范
1. **同一时间只让一个 AI 工作**
2. **切换前必须 `git commit`**
3. **告知对方"现在让 X 操作 Y 模块"**

---

## 📊 系统评分基准

当前系统状态：**66/70 (94%)**

| 维度 | 评分 | 说明 |
|------|------|------|
| 架构设计 | 10/10 | 模块化、可扩展、逻辑闭环 |
| 文件完整性 | 10/10 | 所有规则文件就绪 |
| 实际执行率 | 10/10 | 跨部门联想已激活 |
| 人设对齐 | 10/10 | aboutme.md 被脚本调用 |
| 自省能力 | 10/10 | Error-Reflection 已测试 |
| 验证能力 | 9/10 | 预期输出和失败处理已增强 |
| 上下文管理 | 9/10 | Context Management Protocol 已激活 |

---

## 🚀 v3.0 核心升级说明

基于 Claude Code 创始人 10 条秘籍，系统已完成 7 大升级：

### 升级 #1：验证机制增强
- Slash Commands 现在包含**预期输出**和**失败处理**
- 示例：`/health` 预期 `All services: OK`，失败时触发 Error-Reflection

### 升级 #2：上下文管理策略
- 明确何时运行 `/clear`（任务切换、连续纠错、会话过长）
- 明确何时使用子代理（大规模搜索、深度调研、验证任务）
- 定义上下文优先级（高：aboutme.md、中：CLAUDE.md、低：历史对话）

### 升级 #3：纠错与回滚机制
- 自动识别用户纠错信号（"不对"、"错了"、"撤销"）
- 连续 2 次纠错 → 主动建议 `/clear` 重新开始
- 自我纠错流程：停止 → 反思 → 提供方案 → 记录教训

### 升级 #4：子代理委托策略
- **必须使用**：> 10 文件搜索、> 5 文档调研、全面测试、不确定重构
- **禁止使用**：单文件操作、明确任务、紧急修复
- 子代理汇报标准：发现内容 + 建议行动 + 风险提示

### 升级 #5：多领域任务切换
- 自动识别任务领域（金融/代码/研究/规划）
- 跨领域任务自动拆解和顺序执行
- 优先级冲突时遵循规则优先级并向用户说明

### 升级 #6：并行会话协调
- 定义会话类型：主会话（核心）、辅助会话（独立）、实验会话（高风险）
- 会话间通信协议：通过文件/Git 通信，禁止假设其他会话状态

### 升级 #7：智能任务路由
- 用户输入 → 自动匹配规则文件
- 示例："BTC 今天怎么样？" → 加载 trading.md + aboutme.md
- 模糊任务时询问用户、提供选项、默认保守

---

## 🚀 快速验证

执行以下命令验证你已理解规则：

```bash
# 1. 检查健康状态
python3 【核心脚本】(底层工具箱)/health_monitor.py

# 2. 查看最近报告
ls -lt 【金融汇报】(分析主理人)/今日报告/

# 3. 读取用户人设
cat 【金融汇报】(分析主理人)/Knowledge_Archive/aboutme.md
```

---

## ❓ 常见问题

**Q: 我应该修改哪些文件？**
A: 只修改你负责的模块。不确定时，先问用户。

**Q: 遇到错误怎么办？**
A: 触发 Error-Reflection Protocol，记录到 `error_reflection.md`。

**Q: 如何知道用户的交易风格？**
A: 阅读 `aboutme.md`，所有决策必须符合其中的原则。

**Q: 规则文件可以修改吗？**
A: 可以，但必须先获得用户许可，并记录到 `MEMORY.md`。

---

## 📞 联系方式

- **主 AI**：Claude Code（终端）
- **用户**：AlexWang
- **项目路径**：`/Users/neverdie/iflow_workspace`

---

**欢迎加入团队！请严格遵守以上规则，确保系统稳定运行。**
